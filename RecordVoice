import sounddevice as sd
from scipy.io.wavfile import write
from playsound import playsound
from datetime import datetime

f = 44100  # Sampling frequency

# Ask user to input desired recording duration
try:
    seconds = int(input("Enter recording duration in seconds: "))
except ValueError:
    print("Invalid input. Using default duration of 5 seconds.")
    seconds = 5

# Generate timestamped filename
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
filename = f"Recording_{timestamp}.wav"

# Start recording
print("🎙️ Recording started. Speak now...")
recording = sd.rec(int(seconds * f), samplerate=f, channels=2)
sd.wait()
print(f"✅ Recording finished. Saved as {filename}")

# Save the recording
write(filename, f, recording)

# Ask user if they want to play the recording
play = input("Do you want to play the recording? (y/n): ").strip().lower()
if play == 'y':
    print("🔊 Playing recording...")
    playsound(filename)
else:
    print("⏭️ Playback skipped.")
